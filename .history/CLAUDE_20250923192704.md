# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Technology Stack

**Frontend:**
- React 18 + TypeScript
- Vite (build tool & dev server)
- Redux Toolkit + RTK Query (state management & API calls)
- React Router v6 (routing)
- Tailwind CSS (styling)
- Vitest + React Testing Library (testing)

**Backend:**
- Node.js + Express
- PostgreSQL + Prisma ORM
- JWT authentication (bcryptjs + jsonwebtoken)
- Helmet (security headers)
- Joi (validation)
- Jest + Supertest (testing)

## Development Commands

### Start Development
```bash
npm run dev                 # Start both frontend (port 3000) and backend (port 3001)
npm run dev:frontend        # Start only frontend
npm run dev:backend         # Start only backend
```

### Build
```bash
npm run build               # Build both frontend and backend for production
npm run build:frontend      # Build frontend only
npm run build:backend       # Build backend only
```

### Testing
```bash
npm test                    # Run all tests (frontend + backend)
npm run test:frontend       # Run frontend tests with Vitest
npm run test:backend        # Run backend tests with Jest
npm run test:e2e            # Run E2E tests with Playwright
npm run test:watch          # Run tests in watch mode
```

### Linting & Type Checking
```bash
npm run lint                # Lint all code
npm run lint:frontend       # Lint frontend code
npm run lint:backend        # Lint backend code
npm run typecheck           # Type check all TypeScript
npm run typecheck:frontend  # Type check frontend
npm run typecheck:backend   # Type check backend
```

### Production
```bash
npm start                   # Start production server
npm run preview             # Preview production build locally
```

## Project Architecture

### Directory Structure

```
src/                        # Frontend source
├── components/             # React components
│   ├── common/            # Shared/reusable components
│   ├── forms/             # Form components
│   └── layout/            # Layout components (Header, Footer, etc.)
├── pages/                 # Page-level components
├── hooks/                 # Custom React hooks
├── services/              # API service layer
├── store/                 # Redux store setup
├── utils/                 # Utility functions
└── styles/                # Global styles

server/                    # Backend source
├── routes/                # Express route definitions
├── controllers/           # Request handlers
├── models/                # Database models (Prisma)
├── middleware/            # Custom middleware
├── services/              # Business logic layer
├── utils/                 # Utility functions
└── config/                # Configuration files

tests/                     # Test files
├── frontend/              # Frontend tests
│   ├── components/        # Component tests
│   ├── hooks/             # Hook tests
│   └── integration/       # Integration tests
├── backend/               # Backend tests
│   ├── routes/            # Route tests
│   ├── controllers/       # Controller tests
│   └── models/            # Model tests
├── e2e/                   # End-to-end tests
└── performance/           # Performance tests
```

### Path Aliases

Frontend imports use path aliases:
- `@/*` → `./src/*`
- `@components/*` → `./src/components/*`
- `@pages/*` → `./src/pages/*`
- `@hooks/*` → `./src/hooks/*`
- `@services/*` → `./src/services/*`
- `@store/*` → `./src/store/*`
- `@utils/*` → `./src/utils/*`

Backend imports use:
- `@server/*` → `./server/*`

### Key Design Patterns

1. **Frontend:** Component-based architecture with Redux Toolkit for state management
2. **Backend:** MVC pattern with service layer for business logic
3. **API:** RESTful design with `/api` prefix, proxied through Vite in development
4. **Authentication:** JWT tokens with httpOnly cookies
5. **Validation:** Joi schemas on backend, form validation on frontend
6. **Testing:** Unit tests for components/functions, integration tests for API routes, E2E for user flows

## Development Workflow

1. **Environment Setup:**
   - Copy `.env.example` to `.env` and configure variables
   - Ensure PostgreSQL is running and DATABASE_URL is set
   - Run `npm install` to install dependencies

2. **Database Setup:**
   - Create Prisma schema in `server/prisma/schema.prisma`
   - Run `npx prisma migrate dev` to create migrations
   - Run `npx prisma generate` to generate Prisma client

3. **Development:**
   - Use `npm run dev` to start both servers
   - Frontend runs on `http://localhost:3000`
   - Backend runs on `http://localhost:3001`
   - API calls to `/api/*` are proxied to backend

4. **Code Quality:**
   - Always run `npm run lint` before committing
   - Always run `npm run typecheck` before committing
   - Write tests for new features
   - Follow existing code conventions and patterns

## Important Notes

- **No comments in code** unless explicitly requested
- **Follow existing patterns:** Check neighboring files before creating new components
- **Security:** Never commit secrets, always use environment variables
- **Parallel execution:** When creating related files (component + test + styles), create them in parallel using multiple tool calls
- **Dependencies:** Always verify a library exists in package.json before using it